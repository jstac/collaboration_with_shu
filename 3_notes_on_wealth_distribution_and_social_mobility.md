---
jupytext:
  cell_metadata_filter: -all
  formats: md:myst
  text_representation:
    extension: .md
    format_name: myst
    format_version: '0.8'
    jupytext_version: 1.4.1
kernelspec:
  display_name: Python 3
  language: python
  name: python3
---

# 3 notes on wealth distribution and social mobility

By Shu HU

## 0 intro

### 0.1 motivation

- wealth is unequally distrbuted
- high social mobility

	- intergenerational shorrocks mobility index: 0.88

### 0.2 econ question

- what factors

	- drive wealth dynamics
	- are consistent with the observed

		- cross-sectional wealth distribution
		- social mobility

### 0.3 methods

- develop a simple ifp model
- match the moments generated by model by empirical moments of

	- the observed wealth distribution
	- social mobility matrix

- use this matched model to quantitatively identify the effects of 3 critical factors on the tail of the distribution (generating thick tail) and social mobility

	- A. skew and persistent distribution of stochastic earnings ($:=Y$)
	- B. Differential saving rates across wealth levels ($:=s/a$)

		- higher saving and accumulation rates for the rich
		- forms in literature

			- takes the form of non-homogeneous bequests
			- bequests as a fraction of wealth that are increasing in wealth

	- C. stochastic idiosyncratic returns to wealth/capital income risk ($:=r=R-1$)

		- allowing rates of return on wealth to be increasing in wealth might also add to the skewness of the distribution

### 0.4 Conclusions

- capital income risk
- differential savings
- stochastic earnings

	- limited role in filling the tail of wealth distribution (how to understand "filling")
	- fundamental in inducing enough mobility in the wealth process

- $r$ increases in wealth itself

	- supported in the estimates
	- improve the fit of the model across the wealth distribution

### 0.5 drawbacks

- without directly observing return data, the mechanism above is poorly identified

## 1 model

### 1.1 setups

- each agent's lives $T$ years
- every period $t$

	- consumers choose consumption $c_t$ and
	- accumulate wealth $a_t$
	- subject to a no-borrowing constraint

- consumers leave wealth $a_T$ as a bequest at the end of life $T$.
- each agent's preferences are composed of

	- a per-period utility from consumption, $u(c_t)$, at any period $t=1, \dots, T$

		- $u(c_t) = \frac{c^{1-\sigma}_t}{1- \sigma}$

	- a warm-glow utility from bequests at $T$, $e(a_T)$

		- $e(a_T) = A \frac{a^{1-\mu}_T}{1- \mu}$

- wealth accumulates from

	- savings
	- bequests

- idiosyncratic rates of returns r and life-time labor earnings $y$ ($w$ in his paper)

	- are drawn from a distribution at birth

		- possibly correlated with those of the parent
		- deterministic within each generatioin

	- stochastic over generations only
	- lifetime earnings processes are hump-shaped, with low earnings early in life
	- no-borrowing constraints limit how much agents can smoothing lifetime earnings

### 1.2 notations

- discount rate $\beta < 1$
- present discounted utility of an agent with wealth $a_t$ at the beginning of period $t$: $V_t(a_t)$
- initial wealth: $a_0$
- earnings profiles: $w$
- rate of return: $r$

### 1.3 each agent's maximization problem

- $V_t (a) = \max_{c, a'} u(c) + \beta V_{t+1} (a')$
- s.t.

	- $a' = (1+r)a - c + w$
	- $c \in [0, a], t= 1, \dots, T-1$
	- $V_T(a) = u(c) + e(a')$

### 1.4 optimal wealth processes

- $a_T = g(a_0; r, w)$

	- **CASE 1**: if $\mu = \sigma$, then $g(a_0; r, w) = \alpha(r, w) a_0 + \beta(r, w)$
- $\alpha(r, w)$ is the savings rate and independent of wealth
		- under general conditions (what conditions?), ${a^n}_n$ has a stationary distribution whose tail
		
	- is independent of the distribution of earnings
			- asymptotic to a Pareto law
		
- **CASE 2**: if $\mu < \sigma$, then $g''(a_0;r, w)>0$.
	- keep $\sigma$ constant, differential savings rate emerge
	
		- increasing with wealth
	
	- a stationary distribution might not exist
	- if stationary dist exist, then it displays a thick tail (proved?)
	
- stochastic process over generations: ${r^n, w^n}$

	- finite markov chain
	- $r^n$ are w^n independent, but allowed to be serially correlated with transition matrix
	- life-cycle structure

		- $a^n= a^n_0= a^{n-1}_T$

- $a^n = g(a^{n-1}; r^n, w^n)$

	- stochastic process over generations: ${a^n}_n$ for initial wealth a

### 1.5 easy to extend to: Markov states of the stochastic process for $r$ to depend on the initial wealth of the agent $a$

- optimal wealth processes have similar properties to **CASE 2** above.

## 2 quantitative analysis

### 2.1 methodology

- estimate parameters in the model using the method of simulated moments (MSM) estimators

	- fix (or externally calibrate several parameters of the model
	- select some relevant moments of the wealth process as target in the estimation
	- estimate the remaining parameters by matching the targeted moments generated by the stationary distribution induced by the model and those in the data

- assumption of quantitative exercise

	- wealth and social mobility observed in the data are generated by a stationary distribution

	  Too strong?

- Simulated model can be solved by using **collocation method**, proposed by Miranda and Fackler (2004)
- quantitative exercise

	- 1. fix $\sigma, T, \beta$

		- stochastic individual earnings: w^n with transition matrix $P$ (across generations) estimated from data

			- PSID
			- federal income tax records (Chetty et al, 2014)

	- 2. Target 12 moments

		- bottom 20% + 20-40% + 40-60% + 60-80% + 80-90% + 90-95% + 95-99% + top 1%|wealth shares
		- the diagonal of the (age-independent) social mobility markov chain transition matrix defined over quintiles

	- 3. Estimate 12 parameters

		- preference parameters: $\mu, A$
		- parameters of $r$

			- defined

				- by 5 states $r_i$
				- 5 diagonal transition probabilities: $P(r_i | r_i)$

	- In 3-4,

		- modify $r$ to allow returns to depend on the initial wealth a of the agent
		- experiment with an alternative social mobility matrix

			- defined over the same percentiles of the wealth distribution

### 2.2 data

- labor earnings

	- use 10 deterministic life-cycle household-level earnings profiles at different deciles (construct the earning profiles) 

		- fix each of 6 age brackets, compute averages of the earnings deciles (Heathcote et al 2010) from PSID, 1967-2002 (Table 1)
		- assume agents stay in the same decile for their whole lifetime.
		- agentss randomly draw one of these earnings profiles at the beginning of life according to an intergenerational transition matrix (10 states) reduced from (from Chetty et al, 2014; 100 states; 1980-1982 us birth cohort and their parental income) (Figure 1)

- wealth distribution (Fig2+Table 2)

	- Survey of Consumer Finances 2007
	- wealth variable is net wealth (:=net financial wealth + housing - any debts )
	- skewed-to-right (heavy tail) distribution

		- take the shares from Diaz-Gimenez et al (2011)

- social mobility (wealth transition across generations)

	- mobility matrix calculated by Charles and Hurst (2003) from PSID (Table 3)

		- constructed by means of pairs of simultaneously alive parent and child of different ages
		- compute transitions from the residuals of the wealth of parents and children after conditioning on age and age squared

			- to eliminate age effects

		- shorrocks index: 0.88

- in 3-4, reproduce estimation

	- using an alternative social mobility matrix, using 2007-09 SCF panel data
	- with transitions computed for a synthetic agent over his/her age profile

## 3 estimation results

### 3.1 parameter estimates (baseline: (Table4))

- upper part

	- estimates of preference parameters

- lower part

	- estimated state space
	- diagonal of the transition matrix of the five-state Markov process for $r$ we postulate
	- implied mean and standard deviation of the process
	- autocorrelation computed fitting an $AR(1)$ on simulated data from the estimated process
	- standard errors; obtained by bootstrapping

### 3.2 model fit (compare targeted simulated moments of the estimated model with counterpart in the data) (Table 5)

- compare moments in data with those in simulated
- compute age-independent social mobility moments after conditioning on age and age-squared

### 3.3 discussion and interpretation

- differential savings and bequests (Table 6

	- $\mu = 0.5993 < \sigma = 2$

		- rich save proportionally more than poor

	- $\mu$ depends on $A$
	- average saving rates
	- bequests

		- its dist implied by model is very skewed
		- should include inter vivos transfer (? a transfer made during one's lifetime)

- returns to wealth (Table 7)

	- significant standard deviation and wide dispersion in $r$
	- cautions

		- $r$ is assumed constant over each agent's lifetime, disregarding the whole variation across the life cycle
		- difference in risk composition of investment portfolio might also contribute heterogeneous $r$ in the data

- social mobility (Table 8)

	- fit well compared with Charles and Hurst (2003, Table 2; Table 3 in this paper)
	- slightly overestimate the mobility from the top to the bottom of the distribution vice versa
	- shorrocks index: 0.92

### 3.4 extensions and robustness

- re-estimate model

	- to allow for r dependent on wealth
	- to match an alternative social mobility matrix constructed using 2007-09 panel data

- rate of return positively dependent on wealth

	- positive correlation between r and a does not implies $r$ increases with wealth $a$

		- think about average

	- this add to the skewness of the distribution
	- re-estimate the model using a r dependent on $a$

		- Assume $r = r_0 + b \times p(a)$

			- where

				- $p(a)=1,2, \dots, 8$ moments
				- $r_0$ is a five-state Markov process

		- results

			- better parameters fits
			- better wealth distribution fits

				- top 20%

			- worse social mobility fits

				- dependence of r on wealth a is compensated by a reduced dependence of savings?

		- see Fagereng et al (2017)

- alternative social mobility matrix

	- baseline social mobility matrix

		- constructed by means of pairs of simultaneously alive parents and child
		- does not account for any transition induced by bequests
		- only available for wealth transitions between quintiles, but we care about the heavy tails

			- transitions in and out of the top 1 percent are one of the most relevant characteristics of the stochastic process of the wealth accumulation

	- re-estimate the model using a new social mobility matrix (Table11)

		- method

			- intergenerational transition matrix: each element of the matrix take the form $Pr(a^n_0 \in p|a^{n-1}_0p')$, where p, p' are generic percentiles of the wealth distribution
			- intra-generational transition matrix: $Pr(a^{n-1}_T \in p|a^{n-1}_0 \in p')$
			- divide agent's lifetime $T$ into $k$-periods age groups
			- use the Markov assumption (?) to obtain $Pr(a^{n-1}_T \in p|a^{n-1}_0p')$ from the observation of $Pr(a^{n-1}_k \in p|a^{n-1}_0 \in p')$, $Pr(a^{n-1}_{2k} \in p|a^{n-1}_{k} \in p')$ and so on for all age groups.

				- first construct age-dependent two-year transition matrices for age groups running from 30-31 to 66-67
				- multiply these age-dependent two-year transition matrices for all age groups

			- transitions computed for the same percentiles they use as wealth distribution moments
			- it produces spurious mobility due to measurement error in wealth

		- results

			- display substantial social mobility (shorrocks index: 0.98 vs 0.88 (baseline))
			- re-estimate model

				- gives estimates close to baselines (Table 12)
				- also give fits close to baselines (Table 13)

## 4 counterfactual estimates (by shutting down one factor at a time)

### 4.1 motives

- understand which mechanism mostly affects which dimension of the wealth distribution and mobility
- interpret the counterfactuals as informal tests of identification of these mechanism

	- lack of identification implies that shutting down one or more of the mechanism has limited effects on the fit for the targeted moments

### 4.2 re-estimation

- parameters estimates (Table 14)
- model fit (Table 15)

### 4.3 re-estimation results (see conclusion in intro part)

- no capital income risk (constant $r$)
- no stochastic earnings (constant $w$)
- homogeneous saving rates ($\mu=2$)

## 5 transitional dynamics of the wealth distribution

### 5.1 assumption relaxation

- assumptions above: the observed distribution of wealth is a stationary distribution

	- our estimates are obtained by matching the data with the moments of the stationary distribution generated by the model.

- relax the stationary assumption on wealth distribution

	- try to match the transitional dynamics of the distribution of wealth

### 5.2 method

- use observed SCF 1962-1963 wealth distribution as initial condition
- estimate the parameters of the model by matching the implied distribution after 72 years (two iterations of the model) with (see Table 16)

	- observed SCF 2007 distribution
	- transition matrix adopted in previous analysis

### 5.3 results (see Table 17)

- such a dramatic increase in wealth inequality can be obtained by exploiting the power of capital income risk and differential savings
- A larger bequest motive
- a rate of return process with higher mean and volatility and much more auto-correlation

	- induce a simulated wealth distribution for 2007 is even more skewed at the top
	- the bottom 40% of the wealth distribution is very well matched

- not well fits on social mobility by overestimating mobility all across the distribution

	- mobility is the probability that children move away from their parents' wealth cell
